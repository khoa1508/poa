<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game ƒêi·ªÅn T·ª´ V·ª±ng Ti·∫øng Trung</title>
    <style>
        /* --- CSS Code Starts Here --- */
        body {
            font-family: sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f4f4f4;
            margin: 0;
        }

        .game-container {
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
            width: 90%;
            max-width: 500px;
        }

        h1 {
            color: #333;
            margin-bottom: 20px;
        }

        #timer {
            font-size: 1.2em;
            color: #555;
            margin-bottom: 20px;
        }

        .image-container {
            margin-bottom: 20px;
            min-height: 200px; /* ƒê·∫£m b·∫£o c√≥ kh√¥ng gian khi ·∫£nh ch∆∞a t·∫£i */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #word-image {
            max-width: 100%;
            max-height: 250px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }

        .input-area {
            margin-bottom: 15px;
            display: flex; /* S·∫Øp x·∫øp input v√† button tr√™n c√πng h√†ng */
            justify-content: center; /* CƒÉn gi·ªØa input v√† button */
            gap: 10px; /* Kho·∫£ng c√°ch gi·ªØa input v√† button */
        }

        #answer-input {
            padding: 10px;
            font-size: 1em;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: 60%; /* ƒêi·ªÅu ch·ªânh ƒë·ªô r·ªông c·ªßa input */
        }

        #submit-button, #next-button {
            padding: 10px 15px;
            font-size: 1em;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        #submit-button:hover, #next-button:hover {
            background-color: #0056b3;
        }

        #feedback {
            margin-bottom: 10px;
            font-weight: bold;
            min-height: 1.2em; /* Gi·ªØ kh√¥ng gian cho feedback */
        }

        #feedback.correct {
            color: green;
        }

        #feedback.incorrect {
            color: red;
        }

        #attempts {
            color: #666;
            margin-bottom: 10px;
        }

        #correct-answer {
            margin-top: 15px;
            font-size: 1.1em;
            color: #4CAF50; /* M√†u xanh l√° c√¢y */
            font-weight: bold;
            min-height: 1.2em;
        }

        #final-message {
            margin-top: 20px;
            font-size: 1.2em; /* ƒêi·ªÅu ch·ªânh c·ª° ch·ªØ n·∫øu c·∫ßn */
            font-weight: bold;
            color: #333; /* ƒê·ªïi m√†u ƒë·ªÉ d·ªÖ ƒë·ªçc h∆°n */
            line-height: 1.6; /* TƒÉng kho·∫£ng c√°ch d√≤ng */
            display: none; /* ·∫®n ban ƒë·∫ßu */
            border-top: 1px solid #eee; /* Th√™m ƒë∆∞·ªùng k·∫ª ph√¢n c√°ch */
            padding-top: 15px; /* Th√™m kho·∫£ng ƒë·ªám tr√™n */
        }

        /* ·∫®n n√∫t "Next" ban ƒë·∫ßu */
        #next-button {
            margin-top: 10px; /* Th√™m kho·∫£ng c√°ch tr√™n n·∫øu c·∫ßn */
            background-color: #ffc107; /* M√†u v√†ng */
            color: #333;
            display: none; /* ·∫®n ban ƒë·∫ßu */
        }
        #next-button:hover {
             background-color: #e0a800; /* M√†u v√†ng ƒë·∫≠m h∆°n khi hover */
        }
        /* --- CSS Code Ends Here --- */
    </style>
</head>
<body>
    <div class="game-container">
        <h1>ƒêi·ªÅn T·ª´ V·ª±ng Ti·∫øng Trung</h1>

        <div id="timer">Th·ªùi gian: 00:00</div>

        <div class="image-container">
            <img id="word-image" src="" alt="H√¨nh ·∫£nh t·ª´ v·ª±ng">
        </div>

        <div class="input-area">
            <input type="text" id="answer-input" placeholder="Nh·∫≠p ch·ªØ H√°n...">
            <button id="submit-button">Ki·ªÉm tra</button>
        </div>

        <div id="feedback"></div>
        <div id="attempts">S·ªë l·∫ßn sai c√≤n l·∫°i: 3</div>
        <div id="correct-answer"></div>
        <button id="next-button">T·ª´ Ti·∫øp Theo</button>
         <div id="final-message"></div>
    </div>

    <script>
        // --- JavaScript Code Starts Here ---

        // D·ªØ li·ªáu t·ª´ v·ª±ng (ƒê√£ c·∫≠p nh·∫≠t)
        // L∆ØU √ù: V·∫´n khuy·∫øn kh√≠ch t·∫£i ·∫£nh v·ªÅ v√† d√πng ƒë∆∞·ªùng d·∫´n c·ª•c b·ªô, ƒë·∫∑c bi·ªát cho Zalo Mini App.
        const vocabulary = [
            // T·ª´ c≈©
            { hanzi: "ÁÇ∏È∏°", pinyin: "zh√°jƒ´", imageUrl: "https://upload.wikimedia.org/wikipedia/commons/a/ad/REROWG0011_Shot1_1080x1080_v1.png" },
            { hanzi: "ÈÄöÂ∏∏", pinyin: "t≈çngch√°ng", imageUrl: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQIqfT6Se60L6k4P3af3rVpOYqKPtAoMfq0qQ&s" },
            { hanzi: "Êµ∑È≤ú", pinyin: "h«éixiƒÅn", imageUrl: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRUQxawS8TJIU8tsicgb3VIO-uUY7lszRmwfA&s" },
            { hanzi: "Ëàç‰∏çÂæó", pinyin: "shƒõbude", imageUrl: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR4Xo8ZpClCYUxVqIiEfCWHp8HCGS5dqjRLVw&s" },
            { hanzi: "‰∏∞ÂØå", pinyin: "fƒìngf√π", imageUrl: "https://p6.itc.cn/q_70/images01/20211025/15952c435a0146ec99ea534f930d15ea.jpeg" },
            { hanzi: "Êó∂Â∑Æ", pinyin: "sh√≠chƒÅ", imageUrl: "https://lh6.googleusercontent.com/proxy/SVilHszvLXFuuIT7ma_J9lGlcHwn51XfkrKB4lRzyHaEjWClFuGY8TiEkwFmGy2eVFFS65fNFJtjApk3Jwk1og63uX9jZvjZ3Xe6LieXVYgkF91BFuxlMgI" },
            { hanzi: "Ë∞ÉÊï¥", pinyin: "ti√°ozhƒõng", imageUrl: "https://www.seikowatches.com/-/media/HtmlUploader/Common/Seiko/Home/instructions/html/SEIKO_V131_V145_V147_V157_V158_D_SC/assets/fig/V131D_Set--Time-2-2_BONDILffawgiky.png" },
            { hanzi: "‰ΩúÊÅØ", pinyin: "zu√≤xƒ´", imageUrl: "https://png.pngtree.com/png-vector/20220119/ourmid/pngtree-pupils--healthy-lifestyle-schedule-png-image_4217731.png" },
            { hanzi: "ÈÖíÂêß", pinyin: "ji«îbƒÅ", imageUrl: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSFPzUByXK7tAJcGGNwTkm2a8LjFeDBcdRzJw&s" },
            { hanzi: "Â§úÁå´Â≠ê", pinyin: "y√®mƒÅozi", imageUrl: "https://www.chinlingo.com/daily/upload/ueditor/image/20170112/33681484201563441.jpg" },
            { hanzi: "ÁÜ¨Â§ú", pinyin: "√°oy√®", imageUrl: "https://image.sggp.org.vn/w1000/Uploaded/2025/bwvvopqi/2021_10_31/ban-dem_AEZJ.jpg" },
            // T·ª´ m·ªõi
            { hanzi: "‰øùÊ∏©ÊùØ", pinyin: "B«éowƒìnbƒìi", imageUrl: "https://lh6.googleusercontent.com/proxy/CqAnObeLAZXVTwVQENDmYuyncpcFmrdQHaUfQ1Uu3jmn3HFG2hG8YCjneeA5i4-v16KzlnapibrNaJTEbqJdaflR-ncCig" },
            { hanzi: "Â§™ÊûÅÊã≥", pinyin: "T√†ij√≠qu√°n", imageUrl: "https://www.ihchina.cn/Uploads/Picture/2020/12/14/s5fd73287d8ec4.jpg" },
            { hanzi: "Â®±‰πê", pinyin: "Y√∫l√®", imageUrl: "https://www.pwc.com/gx/en/entertainment-media/outlook-2022/GEMO-super-hero.png" },
            { hanzi: "Á©∫Èó≤", pinyin: "K√≤ngxi√°n", imageUrl: "https://imgsrv2.voi.id/O2ese98JIkeWMU3ZqG3qnn-1fNAw-LEikRyKGSzUU6I/auto/1200/675/sm/1/bG9jYWw6Ly8vcHVibGlzaGVycy8yNjUwOTAvMjAyMzAzMTkxMjEyLW1haW4uY3JvcHBlZF8xNjc5MjAyNzU5LmpwZw.jpg" },
            { hanzi: "Ëπ≤", pinyin: "D≈´n", imageUrl: "https://as.chdev.tw/web/images/article_data/picture_path/img_77215_35c47655-a00a-422b-943d-9d5cc5c409aa.jpg" },
            { hanzi: "È©¨Ê°∂", pinyin: "M«ét«íng", imageUrl: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSH0ta2srphqIKT0_lcBP0ATFOYDZGK45P6NQ&s" },
            { hanzi: "Ê∂àÂåñ", pinyin: "XiƒÅohu√†", imageUrl: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTORln0kGbu5iDlVQHwrCwkYrblqH55CewpDQ&s" }
        ];

        // L·∫•y c√°c ph·∫ßn t·ª≠ DOM
        const wordImage = document.getElementById('word-image');
        const answerInput = document.getElementById('answer-input');
        const submitButton = document.getElementById('submit-button');
        const feedback = document.getElementById('feedback');
        const attemptsDisplay = document.getElementById('attempts');
        const correctAnswerDisplay = document.getElementById('correct-answer');
        const nextButton = document.getElementById('next-button');
        const timerDisplay = document.getElementById('timer');
        const finalMessage = document.getElementById('final-message');


        // Bi·∫øn tr·∫°ng th√°i game
        let currentWordIndex = 0;
        let shuffledVocab = [];
        let wrongAttempts = 0; // S·ªë l·∫ßn sai cho T·ª™ HI·ªÜN T·∫†I
        const maxWrongAttempts = 3;
        let timerInterval = null;
        let startTime = 0;
        let gameEnded = false;
        let score = 0; // Bi·∫øn ƒë·∫øm ƒëi·ªÉm
        let totalIncorrectWords = 0; // Bi·∫øn ƒë·∫øm t·ªïng s·ªë T·ª™ tr·∫£ l·ªùi sai (sau 3 l·∫ßn th·ª≠)

        // H√†m x√°o tr·ªôn m·∫£ng (Fisher-Yates Shuffle)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]]; // Swap elements
            }
        }

        // H√†m b·∫Øt ƒë·∫ßu game
        function startGame() {
            gameEnded = false;
            currentWordIndex = 0;
            wrongAttempts = 0;
            score = 0; // Reset ƒëi·ªÉm
            totalIncorrectWords = 0; // Reset s·ªë t·ª´ sai
            shuffledVocab = [...vocabulary]; // T·∫°o b·∫£n sao v√† x√°o tr·ªôn
            shuffleArray(shuffledVocab);
            finalMessage.style.display = 'none'; // ·∫®n th√¥ng b√°o k·∫øt th√∫c
            finalMessage.textContent = '';
            displayWord();
            startTimer();
            // ƒê·∫£m b·∫£o input v√† button ƒë∆∞·ª£c k√≠ch ho·∫°t khi b·∫Øt ƒë·∫ßu
            answerInput.disabled = false;
            submitButton.disabled = false;
            nextButton.style.display = 'none'; // ·∫®n n√∫t Next khi b·∫Øt ƒë·∫ßu
            answerInput.focus();
        }

        // H√†m hi·ªÉn th·ªã t·ª´ hi·ªán t·∫°i
        function displayWord() {
            if (currentWordIndex >= shuffledVocab.length) {
                endGame();
                return;
            }

            const currentWord = shuffledVocab[currentWordIndex];
            wordImage.src = currentWord.imageUrl;
            wordImage.alt = `H√¨nh ·∫£nh cho ${currentWord.hanzi}`; // Th√™m alt text
            answerInput.value = ''; // X√≥a input c≈©
            feedback.textContent = ''; // X√≥a feedback c≈©
            feedback.className = ''; // X√≥a class feedback
            correctAnswerDisplay.textContent = ''; // X√≥a ƒë√°p √°n c≈©
            wrongAttempts = 0; // Reset s·ªë l·∫ßn sai cho t·ª´ m·ªõi
            updateAttemptsDisplay(); // C·∫≠p nh·∫≠t hi·ªÉn th·ªã s·ªë l·∫ßn sai
            nextButton.style.display = 'none'; // ·∫®n n√∫t "Next"
            answerInput.disabled = false; // K√≠ch ho·∫°t l·∫°i input
            submitButton.disabled = false; // K√≠ch ho·∫°t l·∫°i n√∫t submit
            answerInput.focus(); // Focus v√†o √¥ input
        }

        // H√†m c·∫≠p nh·∫≠t hi·ªÉn th·ªã s·ªë l·∫ßn sai c√≤n l·∫°i cho t·ª´ hi·ªán t·∫°i
        function updateAttemptsDisplay() {
            const remainingAttempts = maxWrongAttempts - wrongAttempts;
            attemptsDisplay.textContent = `S·ªë l·∫ßn sai c√≤n l·∫°i: ${remainingAttempts}`;
        }

        // H√†m ki·ªÉm tra ƒë√°p √°n
        function checkAnswer() {
            if (gameEnded) return; // Kh√¥ng l√†m g√¨ n·∫øu game ƒë√£ k·∫øt th√∫c

            const userAnswer = answerInput.value.trim(); // L·∫•y v√† l√†m s·∫°ch ƒë·∫ßu v√†o
            const currentWord = shuffledVocab[currentWordIndex];
            const correctAnswer = currentWord.hanzi;

            if (!userAnswer) {
                feedback.textContent = 'Vui l√≤ng nh·∫≠p ƒë√°p √°n!';
                feedback.className = 'incorrect';
                return; // Kh√¥ng x·ª≠ l√Ω n·∫øu input tr·ªëng
            }

            if (userAnswer === correctAnswer) {
                score++; // C·ªông ƒëi·ªÉm n·∫øu ƒë√∫ng
                feedback.textContent = 'Ch√≠nh x√°c!';
                feedback.className = 'correct';
                answerInput.disabled = true; // T·∫°m v√¥ hi·ªáu h√≥a khi ch·ªù chuy·ªÉn
                submitButton.disabled = true;
                // T·∫°m d·ª´ng m·ªôt ch√∫t ƒë·ªÉ ng∆∞·ªùi d√πng th·∫•y feedback ƒë√∫ng
                setTimeout(() => {
                    currentWordIndex++;
                    displayWord(); // T·ª± ƒë·ªông g·ªçi displayWord ƒë·ªÉ k√≠ch ho·∫°t l·∫°i n√∫t v√† input
                }, 1000); // Ch·ªù 1 gi√¢y tr∆∞·ªõc khi chuy·ªÉn t·ª´
            } else {
                wrongAttempts++;
                updateAttemptsDisplay();
                feedback.textContent = 'Sai r·ªìi! Th·ª≠ l·∫°i.';
                feedback.className = 'incorrect';
                answerInput.focus(); // Focus l·∫°i v√†o input ƒë·ªÉ th·ª≠ l·∫°i
                answerInput.select(); // Ch·ªçn text c≈© ƒë·ªÉ d·ªÖ d√†ng x√≥a

                if (wrongAttempts >= maxWrongAttempts) {
                    totalIncorrectWords++; // TƒÉng bi·∫øn ƒë·∫øm T·ªîNG S·ªê T·ª™ sai
                    feedback.textContent = 'B·∫°n ƒë√£ h·∫øt l∆∞·ª£t th·ª≠!';
                    correctAnswerDisplay.textContent = `ƒê√°p √°n ƒë√∫ng: ${currentWord.hanzi} (${currentWord.pinyin})`;
                    answerInput.disabled = true; // V√¥ hi·ªáu h√≥a input
                    submitButton.disabled = true; // V√¥ hi·ªáu h√≥a n√∫t submit
                    nextButton.style.display = 'inline-block'; // Hi·ªÉn th·ªã n√∫t "Next"
                }
            }
        }

        // H√†m chuy·ªÉn sang t·ª´ ti·∫øp theo sau khi sai qu√° 3 l·∫ßn
        function nextWordAfterFail() {
            currentWordIndex++;
            displayWord();
        }

        // H√†m b·∫Øt ƒë·∫ßu ƒë·∫øm gi·ªù
        function startTimer() {
            clearInterval(timerInterval); // X√≥a interval c≈© n·∫øu c√≥
            startTime = Date.now();
            timerInterval = setInterval(() => {
                if (gameEnded) return; // D·ª´ng c·∫≠p nh·∫≠t n·∫øu game ƒë√£ k·∫øt th√∫c

                const elapsedTime = Date.now() - startTime;
                const seconds = Math.floor((elapsedTime / 1000) % 60);
                const minutes = Math.floor((elapsedTime / (1000 * 60)) % 60);

                // ƒê·ªãnh d·∫°ng MM:SS
                const formattedTime = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                timerDisplay.textContent = `Th·ªùi gian: ${formattedTime}`;
            }, 1000); // C·∫≠p nh·∫≠t m·ªói gi√¢y
        }

        // H√†m d·ª´ng ƒë·∫øm gi·ªù
        function stopTimer() {
            clearInterval(timerInterval);
        }

        // H√†m k·∫øt th√∫c game (ƒê√£ c·∫≠p nh·∫≠t)
        function endGame() {
            gameEnded = true;
            stopTimer();
            wordImage.src = ""; // X√≥a ·∫£nh cu·ªëi c√πng
            wordImage.alt = "Tr√≤ ch∆°i k·∫øt th√∫c";
            answerInput.disabled = true;
            submitButton.disabled = true;
            nextButton.style.display = 'none';
            feedback.textContent = '';
            attemptsDisplay.textContent = '';
            correctAnswerDisplay.textContent = '';

            const finalTime = timerDisplay.textContent; // L·∫•y th·ªùi gian cu·ªëi c√πng ƒë√£ ƒë∆∞·ª£c ƒë·ªãnh d·∫°ng
            const totalWords = shuffledVocab.length; // T·ªïng s·ªë t·ª´ ƒë√£ ch∆°i

            // Hi·ªÉn th·ªã b·∫£ng t·ªïng k·∫øt
            finalMessage.innerHTML = `
                <strong>üéâ Ho√†n th√†nh! üéâ</strong><br>
                ${finalTime}<br>
                ƒêi·ªÉm: ${score} / ${totalWords}<br>
                S·ªë c√¢u tr·∫£ l·ªùi sai: ${totalIncorrectWords}
            `; // S·ª≠ d·ª•ng innerHTML ƒë·ªÉ cho ph√©p d√πng <br> v√† <strong>
            finalMessage.style.display = 'block'; // Hi·ªán b·∫£ng t·ªïng k·∫øt

            // T√πy ch·ªçn: Th√™m n√∫t Ch∆°i l·∫°i
            // const restartButton = document.createElement('button');
            // restartButton.textContent = 'Ch∆°i l·∫°i';
            // restartButton.style.marginTop = '15px'; // Th√™m kho·∫£ng c√°ch
            // restartButton.onclick = startGame;
            // finalMessage.appendChild(restartButton); // Th√™m n√∫t v√†o cu·ªëi b·∫£ng t·ªïng k·∫øt
        }

        // --- Kh·ªüi ch·∫°y Game ---
        // Th√™m s·ª± ki·ªán listener
        submitButton.addEventListener('click', checkAnswer);
        nextButton.addEventListener('click', nextWordAfterFail);

        // Cho ph√©p nh·∫•n Enter ƒë·ªÉ ki·ªÉm tra ƒë√°p √°n
        answerInput.addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                event.preventDefault(); // NgƒÉn h√†nh vi m·∫∑c ƒë·ªãnh c·ªßa Enter (vd: submit form)
                // Ch·ªâ g·ªçi checkAnswer n·∫øu n√∫t submit ƒëang ƒë∆∞·ª£c k√≠ch ho·∫°t
                if (!submitButton.disabled) {
                     checkAnswer();
                }
            }
        });

        // B·∫Øt ƒë·∫ßu game khi trang t·∫£i xong
        document.addEventListener('DOMContentLoaded', startGame); // ƒê·∫£m b·∫£o DOM s·∫µn s√†ng tr∆∞·ªõc khi ch·∫°y game

        // --- JavaScript Code Ends Here ---
    </script>
</body>
</html>